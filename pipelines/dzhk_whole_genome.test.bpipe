// A short description of the pipeline here

about title: "A pipeline for the DZHK Omics WGS project - works with CRAM files."

inputs "fastq.gz" : "Expecting compressed fastq files (fastq.gz)"

load 'dzhk_whole_genome.config'

// AH81VLADXX_U0b_TGACCA_L002_R1.fastq.gz

run {  "%_*.fastq.gz" * [ 
	pipeline_prepare + "%_%_%_%_R*.fastq.gz" * [ 
		trimmomatic + bwa_pipeline + gatk_base_recalibrate + gatk_print_reads
	] 
	+ "*.bam" * [ samtools_merge + samtools_index ]
        + [ 
		freebayes_parallel.using(procs:16) + vcffilter + vep.using(format:"json"),
		gatk_haplotype_caller + [
			gatk_select_variants.using(select:"SNP") + gatk_variant_recalibrator.using(mode:"SNP") + gatk_apply_recalibration + vep.using(format:"json"),
			gatk_select_variants.using(select:"INDEL") + gatk_variant_recalibrator.using(mode:"INDEL") + gatk_apply_recalibration + vep.using(format:"json")
		]

	]
] }


